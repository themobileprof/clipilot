name: database_clients_install
id: org.themobileprof.database_clients_install
version: 1.0.0
description: Install database client tools (PostgreSQL, MySQL, MongoDB, Redis, SQLite) with individual selection and Termux compatibility
tags: [installer, composite, database, development, termux-compatible]
provides:
  - database_clients_installed
requires:
  - check_command_exists
size_kb: 15

flows:
  main:
    start: check_existing
    steps:
      check_existing:
        type: action
        message: "Checking installed database clients..."
        command: |
          echo "üóÑÔ∏è  Database Client Tools Installation"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo ""
          echo "Checking current installation status:"
          
          if command -v psql >/dev/null 2>&1; then
            echo "  ‚úÖ PostgreSQL client: $(psql --version | head -1)"
          else
            echo "  ‚ùå PostgreSQL client: not installed"
          fi
          
          if command -v mysql >/dev/null 2>&1; then
            echo "  ‚úÖ MySQL client: $(mysql --version | head -1)"
          else
            echo "  ‚ùå MySQL client: not installed"
          fi
          
          if command -v mongosh >/dev/null 2>&1; then
            echo "  ‚úÖ MongoDB Shell (mongosh): $(mongosh --version | head -1)"
          elif command -v mongo >/dev/null 2>&1; then
            echo "  ‚úÖ MongoDB client (legacy): $(mongo --version | head -1)"
          else
            echo "  ‚ùå MongoDB client: not installed"
          fi
          
          if command -v redis-cli >/dev/null 2>&1; then
            echo "  ‚úÖ Redis client: $(redis-cli --version | head -1)"
          else
            echo "  ‚ùå Redis client: not installed"
          fi
          
          if command -v sqlite3 >/dev/null 2>&1; then
            echo "  ‚úÖ SQLite: $(sqlite3 --version | head -1)"
          else
            echo "  ‚ùå SQLite: not installed"
          fi
          
          if command -v mariadb >/dev/null 2>&1; then
            echo "  ‚úÖ MariaDB client: $(mariadb --version | head -1)"
          else
            echo "  ‚ùå MariaDB client: not installed"
          fi
          
          echo ""
        next: detect_environment

      detect_environment:
        type: action
        message: "Detecting environment..."
        command: |
          if [ -n "$TERMUX_VERSION" ] || [ -d "$PREFIX" ]; then
            echo "TERMUX"
          else
            echo "STANDARD"
          fi
        next: branch_environment

      branch_environment:
        type: branch
        message: "Configuring for environment..."
        based_on: last_output
        branches:
          TERMUX:
            next: explain_process_termux
          STANDARD:
            next: explain_process_standard
          default:
            next: explain_process_standard

      explain_process_termux:
        type: action
        message: "Starting installation wizard for Termux..."
        command: |
          echo "üóÑÔ∏è  Database Client Tools Installation Wizard (Termux)"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo ""
          echo "üì± Termux Environment Detected"
          echo ""
          echo "‚ö†Ô∏è  Termux Notes:"
          echo "  ‚Ä¢ PostgreSQL: Full server + client available"
          echo "  ‚Ä¢ MySQL/MariaDB: MariaDB available (MySQL replacement)"
          echo "  ‚Ä¢ MongoDB: NOT available in Termux repositories"
          echo "  ‚Ä¢ Redis: Full server + client available"
          echo "  ‚Ä¢ SQLite: Fully supported"
          echo ""
          echo "You will be asked about each tool individually."
          echo ""
          
          # Initialize selections
          echo "NONE" > /tmp/clipilot_selected_db_clients.txt
          echo "TERMUX" > /tmp/clipilot_db_env.txt
        next: ask_postgresql

      explain_process_standard:
        type: action
        message: "Starting installation wizard..."
        command: |
          echo "üóÑÔ∏è  Database Client Tools Installation Wizard"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo ""
          echo "üíª Standard Linux Environment"
          echo ""
          echo "You will be asked about each tool individually."
          echo "Client-only packages will be installed (no servers)."
          echo ""
          
          # Initialize selections
          echo "NONE" > /tmp/clipilot_selected_db_clients.txt
          echo "STANDARD" > /tmp/clipilot_db_env.txt
        next: ask_postgresql

      ask_postgresql:
        type: instruction
        message: |
          
          üêò PostgreSQL Client (psql)
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          ‚Ä¢ Command-line client for PostgreSQL databases
          ‚Ä¢ Connect to local or remote PostgreSQL servers
          ‚Ä¢ Execute SQL queries, import/export data
          ‚Ä¢ Most popular open-source relational database
          ‚Ä¢ Size: ~50 MB (Termux: includes server)
          ‚Ä¢ Usage: psql -h host -U user -d database
          
        command: |
          ENV=$(cat /tmp/clipilot_db_env.txt)
          if [ "$ENV" = "TERMUX" ]; then
            echo "  Note: Termux installs PostgreSQL server + client together"
          fi
          
          read -p "Install PostgreSQL client? (Y/n): " -r
          echo
          if [[ ! $REPLY =~ ^[Nn]$ ]]; then
            echo "postgresql" >> /tmp/clipilot_selected_db_clients.txt
            echo "YES"
          else
            echo "NO"
          fi
        next: ask_mysql

      ask_mysql:
        type: instruction
        message: |
          
          üê¨ MySQL/MariaDB Client
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          ‚Ä¢ Command-line client for MySQL/MariaDB databases
          ‚Ä¢ Connect to local or remote MySQL servers
          ‚Ä¢ Execute SQL queries, manage databases
          ‚Ä¢ Industry standard relational database
          ‚Ä¢ Size: ~30 MB (Termux: MariaDB client)
          ‚Ä¢ Usage: mysql -h host -u user -p database
          
        command: |
          ENV=$(cat /tmp/clipilot_db_env.txt)
          if [ "$ENV" = "TERMUX" ]; then
            echo "  Note: Termux provides MariaDB (MySQL-compatible)"
          fi
          
          read -p "Install MySQL/MariaDB client? (Y/n): " -r
          echo
          if [[ ! $REPLY =~ ^[Nn]$ ]]; then
            echo "mysql" >> /tmp/clipilot_selected_db_clients.txt
            echo "YES"
          else
            echo "NO"
          fi
        next: ask_mongodb

      ask_mongodb:
        type: instruction
        message: |
          
          üçÉ MongoDB Client (mongosh)
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          ‚Ä¢ Modern MongoDB Shell for NoSQL databases
          ‚Ä¢ Connect to MongoDB servers (local/remote/cloud)
          ‚Ä¢ JavaScript-based query interface
          ‚Ä¢ Popular document-oriented database
          ‚Ä¢ Size: ~30 MB
          ‚Ä¢ Usage: mongosh "mongodb://host:27017"
          
        command: |
          ENV=$(cat /tmp/clipilot_db_env.txt)
          if [ "$ENV" = "TERMUX" ]; then
            echo ""
            echo "  ‚ö†Ô∏è  WARNING: MongoDB is NOT available in Termux!"
            echo "  You can use MongoDB Atlas (cloud) from any device."
            echo ""
            read -p "Skip MongoDB (recommended for Termux)? (Y/n): " -r
            echo
            if [[ $REPLY =~ ^[Nn]$ ]]; then
              echo "mongodb" >> /tmp/clipilot_selected_db_clients.txt
              echo "WILL_FAIL"
            else
              echo "SKIP"
            fi
          else
            read -p "Install MongoDB client? (Y/n): " -r
            echo
            if [[ ! $REPLY =~ ^[Nn]$ ]]; then
              echo "mongodb" >> /tmp/clipilot_selected_db_clients.txt
              echo "YES"
            else
              echo "NO"
            fi
          fi
        next: ask_redis

      ask_redis:
        type: instruction
        message: |
          
          üî¥ Redis Client (redis-cli)
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          ‚Ä¢ Command-line client for Redis
          ‚Ä¢ Connect to Redis servers (key-value store)
          ‚Ä¢ Execute Redis commands, manage cache
          ‚Ä¢ Blazing fast in-memory data structure store
          ‚Ä¢ Size: ~5 MB (Termux: includes server)
          ‚Ä¢ Usage: redis-cli -h host -p 6379
          
        command: |
          ENV=$(cat /tmp/clipilot_db_env.txt)
          if [ "$ENV" = "TERMUX" ]; then
            echo "  Note: Termux installs Redis server + client together"
          fi
          
          read -p "Install Redis client? (Y/n): " -r
          echo
          if [[ ! $REPLY =~ ^[Nn]$ ]]; then
            echo "redis" >> /tmp/clipilot_selected_db_clients.txt
            echo "YES"
          else
            echo "NO"
          fi
        next: ask_sqlite

      ask_sqlite:
        type: instruction
        message: |
          
          üì¶ SQLite
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          ‚Ä¢ Lightweight embedded SQL database
          ‚Ä¢ Serverless, self-contained, zero-configuration
          ‚Ä¢ Perfect for local data storage and testing
          ‚Ä¢ Used by Android, iOS, browsers, and many apps
          ‚Ä¢ Size: ~2 MB
          ‚Ä¢ Usage: sqlite3 database.db
          
        command: |
          read -p "Install SQLite? (Y/n): " -r
          echo
          if [[ ! $REPLY =~ ^[Nn]$ ]]; then
            echo "sqlite" >> /tmp/clipilot_selected_db_clients.txt
            echo "YES"
          else
            echo "NO"
          fi
        next: confirm_selections

      confirm_selections:
        type: action
        message: "Reviewing selections..."
        command: |
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          ENV=$(cat /tmp/clipilot_db_env.txt)
          
          if [ -z "$SELECTED" ]; then
            echo "NO_TOOLS_SELECTED"
          else
            echo ""
            echo "‚úì Selected database clients for installation:"
            echo "$SELECTED" | while read tool; do
              case "$tool" in
                postgresql)
                  if [ "$ENV" = "TERMUX" ]; then
                    echo "  ‚Ä¢ PostgreSQL (server + client)"
                  else
                    echo "  ‚Ä¢ PostgreSQL client (psql)"
                  fi
                  ;;
                mysql)
                  if [ "$ENV" = "TERMUX" ]; then
                    echo "  ‚Ä¢ MariaDB client (MySQL-compatible)"
                  else
                    echo "  ‚Ä¢ MySQL client"
                  fi
                  ;;
                mongodb) echo "  ‚Ä¢ MongoDB Shell (mongosh)" ;;
                redis)
                  if [ "$ENV" = "TERMUX" ]; then
                    echo "  ‚Ä¢ Redis (server + client)"
                  else
                    echo "  ‚Ä¢ Redis client (redis-cli)"
                  fi
                  ;;
                sqlite) echo "  ‚Ä¢ SQLite" ;;
              esac
            done
            echo ""
            
            if [ "$ENV" = "TERMUX" ]; then
              echo "üì± Termux Note: Some packages include full servers"
            fi
            echo ""
            echo "TOOLS_SELECTED"
          fi
        next: branch_selections

      branch_selections:
        type: branch
        message: "Processing selections..."
        based_on: last_output
        branches:
          NO_TOOLS_SELECTED:
            next: installation_cancelled
          TOOLS_SELECTED:
            next: detect_package_manager
          default:
            next: installation_cancelled

      installation_cancelled:
        type: terminal
        message: |
          
          ‚ö†Ô∏è  No database clients selected for installation.
          
          You can install database clients later by running:
            clipilot run database_clients_install

      detect_package_manager:
        type: action
        message: "Detecting package manager..."
        command: |
          if [ -n "$TERMUX_VERSION" ] || [ -d "$PREFIX" ]; then
            echo "TERMUX"
          elif command -v apt-get >/dev/null 2>&1; then
            echo "APT"
          elif command -v dnf >/dev/null 2>&1; then
            echo "DNF"
          elif command -v yum >/dev/null 2>&1; then
            echo "YUM"
          elif command -v pacman >/dev/null 2>&1; then
            echo "PACMAN"
          elif command -v brew >/dev/null 2>&1; then
            echo "BREW"
          else
            echo "UNKNOWN"
          fi
        next: branch_package_manager

      branch_package_manager:
        type: branch
        message: "Selecting installation method..."
        based_on: last_output
        branches:
          TERMUX:
            next: install_termux
          APT:
            next: install_apt
          DNF:
            next: install_dnf
          YUM:
            next: install_yum
          PACMAN:
            next: install_pacman
          BREW:
            next: install_brew
          default:
            next: install_unsupported

      install_termux:
        type: action
        message: "Installing selected database clients for Termux..."
        command: |
          echo "Installing database clients for Termux..."
          echo ""
          
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          
          echo "$SELECTED" | while read tool; do
            case "$tool" in
              postgresql)
                echo "üì¶ Installing PostgreSQL (server + client)..."
                pkg install -y postgresql
                echo "  Setting up PostgreSQL..."
                mkdir -p $PREFIX/var/lib/postgresql
                initdb $PREFIX/var/lib/postgresql 2>/dev/null || echo "  Database already initialized"
                echo ""
                echo "  To start PostgreSQL server:"
                echo "    pg_ctl -D \$PREFIX/var/lib/postgresql start"
                ;;
              mysql)
                echo "üì¶ Installing MariaDB client..."
                pkg install -y mariadb
                echo "  MariaDB client installed (mysql and mariadb commands)"
                ;;
              mongodb)
                echo "‚ö†Ô∏è  Skipping MongoDB (not available in Termux)"
                echo "  Consider using MongoDB Atlas (cloud): https://www.mongodb.com/atlas"
                ;;
              redis)
                echo "üì¶ Installing Redis (server + client)..."
                pkg install -y redis
                echo ""
                echo "  To start Redis server:"
                echo "    redis-server \$PREFIX/etc/redis.conf &"
                ;;
              sqlite)
                echo "üì¶ Installing SQLite..."
                pkg install -y sqlite
                ;;
            esac
            echo ""
          done
          
          rm -f /tmp/clipilot_selected_db_clients.txt
          rm -f /tmp/clipilot_db_env.txt
          echo "‚úÖ Selected database clients installed successfully!"
        next: show_summary

      install_apt:
        type: action
        message: "Installing selected database clients..."
        command: |
          echo "Installing database clients (Debian/Ubuntu)..."
          echo ""
          
          sudo apt-get update
          echo ""
          
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          
          echo "$SELECTED" | while read tool; do
            case "$tool" in
              postgresql)
                echo "üì¶ Installing PostgreSQL client..."
                sudo apt-get install -y postgresql-client
                ;;
              mysql)
                echo "üì¶ Installing MySQL client..."
                sudo apt-get install -y mysql-client
                ;;
              mongodb)
                echo "üì¶ Installing MongoDB Shell..."
                # MongoDB requires special repo setup on Debian/Ubuntu
                if ! command -v mongosh >/dev/null 2>&1; then
                  echo "  Installing from MongoDB repository..."
                  wget -qO - https://www.mongodb.org/static/pgp/server-7.0.asc | sudo apt-key add - 2>/dev/null
                  echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu $(lsb_release -cs)/mongodb-org/7.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-7.0.list >/dev/null 2>&1
                  sudo apt-get update 2>/dev/null
                  sudo apt-get install -y mongodb-mongosh 2>/dev/null || echo "  Note: Manual installation may be required - visit https://www.mongodb.com/try/download/shell"
                fi
                ;;
              redis)
                echo "üì¶ Installing Redis client..."
                sudo apt-get install -y redis-tools
                ;;
              sqlite)
                echo "üì¶ Installing SQLite..."
                sudo apt-get install -y sqlite3
                ;;
            esac
            echo ""
          done
          
          rm -f /tmp/clipilot_selected_db_clients.txt
          rm -f /tmp/clipilot_db_env.txt
          echo "‚úÖ Selected database clients installed successfully!"
        next: show_summary

      install_dnf:
        type: action
        message: "Installing selected database clients..."
        command: |
          echo "Installing database clients (Fedora/RHEL)..."
          echo ""
          
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          
          echo "$SELECTED" | while read tool; do
            case "$tool" in
              postgresql)
                echo "üì¶ Installing PostgreSQL client..."
                sudo dnf install -y postgresql
                ;;
              mysql)
                echo "üì¶ Installing MySQL client..."
                sudo dnf install -y mysql
                ;;
              mongodb)
                echo "üì¶ Installing MongoDB Shell..."
                sudo dnf install -y mongodb-mongosh 2>/dev/null || echo "  Note: Visit https://www.mongodb.com/try/download/shell for manual installation"
                ;;
              redis)
                echo "üì¶ Installing Redis client..."
                sudo dnf install -y redis
                ;;
              sqlite)
                echo "üì¶ Installing SQLite..."
                sudo dnf install -y sqlite
                ;;
            esac
            echo ""
          done
          
          rm -f /tmp/clipilot_selected_db_clients.txt
          rm -f /tmp/clipilot_db_env.txt
          echo "‚úÖ Selected database clients installed successfully!"
        next: show_summary

      install_yum:
        type: action
        message: "Installing selected database clients..."
        command: |
          echo "Installing database clients (CentOS/RHEL)..."
          echo ""
          
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          
          echo "$SELECTED" | while read tool; do
            case "$tool" in
              postgresql)
                echo "üì¶ Installing PostgreSQL client..."
                sudo yum install -y postgresql
                ;;
              mysql)
                echo "üì¶ Installing MySQL client..."
                sudo yum install -y mysql
                ;;
              mongodb)
                echo "üì¶ Installing MongoDB Shell..."
                sudo yum install -y mongodb-mongosh 2>/dev/null || echo "  Note: Visit https://www.mongodb.com/try/download/shell for manual installation"
                ;;
              redis)
                echo "üì¶ Installing Redis..."
                sudo yum install -y redis
                ;;
              sqlite)
                echo "üì¶ Installing SQLite..."
                sudo yum install -y sqlite
                ;;
            esac
            echo ""
          done
          
          rm -f /tmp/clipilot_selected_db_clients.txt
          rm -f /tmp/clipilot_db_env.txt
          echo "‚úÖ Selected database clients installed successfully!"
        next: show_summary

      install_pacman:
        type: action
        message: "Installing selected database clients..."
        command: |
          echo "Installing database clients (Arch Linux)..."
          echo ""
          
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          
          echo "$SELECTED" | while read tool; do
            case "$tool" in
              postgresql)
                echo "üì¶ Installing PostgreSQL client..."
                sudo pacman -S --noconfirm postgresql-libs
                ;;
              mysql)
                echo "üì¶ Installing MySQL client..."
                sudo pacman -S --noconfirm mariadb-clients
                ;;
              mongodb)
                echo "üì¶ Installing MongoDB Shell..."
                sudo pacman -S --noconfirm mongodb-tools mongosh 2>/dev/null || echo "  Note: May need to install from AUR"
                ;;
              redis)
                echo "üì¶ Installing Redis..."
                sudo pacman -S --noconfirm redis
                ;;
              sqlite)
                echo "üì¶ Installing SQLite..."
                sudo pacman -S --noconfirm sqlite
                ;;
            esac
            echo ""
          done
          
          rm -f /tmp/clipilot_selected_db_clients.txt
          rm -f /tmp/clipilot_db_env.txt
          echo "‚úÖ Selected database clients installed successfully!"
        next: show_summary

      install_brew:
        type: action
        message: "Installing selected database clients..."
        command: |
          echo "Installing database clients (macOS)..."
          echo ""
          
          SELECTED=$(cat /tmp/clipilot_selected_db_clients.txt | grep -v "NONE" | sort | uniq)
          
          echo "$SELECTED" | while read tool; do
            case "$tool" in
              postgresql)
                echo "üì¶ Installing PostgreSQL client..."
                brew install libpq
                echo "  Note: Add /opt/homebrew/opt/libpq/bin to PATH"
                ;;
              mysql)
                echo "üì¶ Installing MySQL client..."
                brew install mysql-client
                echo "  Note: Add /opt/homebrew/opt/mysql-client/bin to PATH"
                ;;
              mongodb)
                echo "üì¶ Installing MongoDB Shell..."
                brew install mongosh
                ;;
              redis)
                echo "üì¶ Installing Redis..."
                brew install redis
                ;;
              sqlite)
                echo "üì¶ Installing SQLite..."
                brew install sqlite3
                ;;
            esac
            echo ""
          done
          
          rm -f /tmp/clipilot_selected_db_clients.txt
          rm -f /tmp/clipilot_db_env.txt
          echo "‚úÖ Selected database clients installed successfully!"
        next: show_summary

      install_unsupported:
        type: terminal
        message: |
          
          ‚ùå Unsupported package manager
          
          Please install database clients manually using your system's package manager.
          
          Download links:
          ‚Ä¢ PostgreSQL: https://www.postgresql.org/download/
          ‚Ä¢ MySQL: https://dev.mysql.com/downloads/
          ‚Ä¢ MongoDB Shell: https://www.mongodb.com/try/download/shell
          ‚Ä¢ Redis: https://redis.io/download
          ‚Ä¢ SQLite: https://www.sqlite.org/download.html

      show_summary:
        type: terminal
        message: |
          
          ==========================================
            Database Clients Installed!
          ==========================================
          
          Installed clients:
            ‚Ä¢ PostgreSQL: $(command -v psql >/dev/null 2>&1 && echo "‚úÖ $(psql --version)" || echo "‚ùå not installed")
            ‚Ä¢ MySQL/MariaDB: $(command -v mysql >/dev/null 2>&1 && echo "‚úÖ $(mysql --version)" || echo "‚ùå not installed")
            ‚Ä¢ MongoDB: $(command -v mongosh >/dev/null 2>&1 && echo "‚úÖ $(mongosh --version)" || (command -v mongo >/dev/null 2>&1 && echo "‚úÖ legacy mongo client" || echo "‚ùå not installed"))
            ‚Ä¢ Redis: $(command -v redis-cli >/dev/null 2>&1 && echo "‚úÖ $(redis-cli --version)" || echo "‚ùå not installed")
            ‚Ä¢ SQLite: $(command -v sqlite3 >/dev/null 2>&1 && echo "‚úÖ $(sqlite3 --version)" || echo "‚ùå not installed")
          
          Quick connection examples:
            ‚Ä¢ PostgreSQL:  psql -h localhost -U postgres -d mydb
            ‚Ä¢ MySQL:       mysql -h localhost -u root -p mydb
            ‚Ä¢ MongoDB:     mongosh "mongodb://localhost:27017/mydb"
            ‚Ä¢ Redis:       redis-cli -h localhost -p 6379
            ‚Ä¢ SQLite:      sqlite3 database.db
          
          Common operations:
            üìä List databases:
              PostgreSQL:  \l (in psql)
              MySQL:       SHOW DATABASES;
              MongoDB:     show dbs
              Redis:       INFO keyspace
              SQLite:      .databases
          
            üîç Connect to database:
              PostgreSQL:  \c database_name
              MySQL:       USE database_name;
              MongoDB:     use database_name
              Redis:       SELECT 0
              SQLite:      (specify file: sqlite3 mydb.db)
          
            üìù Execute SQL file:
              PostgreSQL:  psql -f script.sql
              MySQL:       mysql < script.sql
              SQLite:      sqlite3 db.db < script.sql
          
          Environment-specific notes:
            $(if [ -n "$TERMUX_VERSION" ] || [ -d "$PREFIX" ]; then
              echo "üì± Termux: PostgreSQL/Redis include full servers"
              echo "   Start servers before connecting to localhost"
              echo "   PostgreSQL: pg_ctl -D \$PREFIX/var/lib/postgresql start"
              echo "   Redis: redis-server \$PREFIX/etc/redis.conf &"
            else
              echo "üíª Standard Linux: Client-only packages installed"
              echo "   Connect to remote databases or install servers separately"
            fi)
          
          Connection strings:
            PostgreSQL:  postgresql://user:pass@host:5432/dbname
            MySQL:       mysql://user:pass@host:3306/dbname
            MongoDB:     mongodb://user:pass@host:27017/dbname
            Redis:       redis://user:pass@host:6379/0
          
          üîí Security tip: Never hardcode credentials in code!
               Use environment variables or config files.

metadata:
  author: TheMobileProf
  license: MIT
